# Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or
# http://www.apache.org/licenses/LICENSE-2.0>.
# This file may not be copied, modified, or distributed
# except according to those terms.
#
# Environment configuration file for the Data and Vis SDK on Frontier
#   maintainer: Ryan Krattiger @kwryankrattiger (ryan.krattiger@kitware.com)
spack:
  config:
    install_tree:
      root: $DEPLOY_PREFIX
      padding: 128

  view: false

  include:
  - $FACILITY_CONFIG_ROOT/frontier/rocm-6.0.0/packages.yaml
  - $FACILITY_CONFIG_ROOT/frontier/rocm-6.0.0/compilers.yaml
  - $FACILITY_CONFIG_ROOT/frontier/compilers.yaml
  - $FACILITY_CONFIG_ROOT/frontier/packages.yaml
  - $DAV_SDK_CONFIG_ROOT/spack/configs/packages.yaml
  - $DAV_SDK_CONFIG_ROOT/spack/configs/frontier/modules.yaml

  packages:
    paraview:
      require:
      - +raytracing

  definitions:
  - paraview_specs:
    - matrix:
      - - paraview
      - - "@5.11.2"
        - "@5.12.1"
        - "@5.13.1"

  - rocm_package:
    - +rocm amdgpu_target=gfx90a
    - ~rocm

  specs:
  # I/O
  - matrix:
    - - adios2
    - - $rocm_package

  - parallel-netcdf
  - hdf5
  - hdf5-vol-async
  - hdf5-vol-cache
  - hdf5-vol-log

  # Compression
  - zfp

  # Visualization
  - matrix:
    - - ascent
    - - ^vtk-m +rocm amdgpu_target=gfx90a
      - ^vtk-m ~rocm

  - matrix:
    - - $paraview_specs
    - - $rocm_package

  - matrix:
    - - vtk-m
    - - $rocm_package

  concretizer:
    unify: when_possible
    reuse: false
