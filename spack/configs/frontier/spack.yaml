# This is a Spack Environment file.
#
# It describes a set of packages to be installed, along with
# configuration settings.
spack:
  config:
    install_tree:
      root: /sw/frontier/ums/ums032/spack/
      padding: 128

  include:
  - ../packages.yaml
  # Facility configs
  - https://github.com/E4S-Project/facility-external-spack-configs/tree/master/frontier/compilers.yaml
  - https://github.com/E4S-Project/facility-external-spack-configs/tree/master/frontier/packages.yaml
  # Use the ROCm 5.3.0 packages
  - https://github.com/E4S-Project/facility-external-spack-configs/tree/master/frontier/rocm-5.3.0/packages.yaml

  definitions:
  - paraview:
    - matrix:
      - - paraview
      - - "@5.11"
        - "@5.12"
        # - "@5.13"

  - rocm_package:
    - +rocm amdgpu_arch=gfx90a
    - ~rocm

  specs:
  # I/O
  - matrix:
    - - adios2
    - - $rocm_package

  - parallel-netcdf
  - hdf5
  - hdf5-vol-async
  - hdf5-vol-cache
  - hdf5-vol-log

  # Compression
  - zfp

  # Visualization
  - matrix:
    - - ascent
    - - ^vtk-m +rocm
      - ^vtk-m ~rocm

  - matrix:
    - - $paraview
    - - $rocm_package

  - matrix:
    - - vtk-m
    - - $rocm_package

  concretizer:
    unify: when_possible
